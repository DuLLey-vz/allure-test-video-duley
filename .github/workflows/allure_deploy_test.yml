name: Allure Report (History 5)

on:
  workflow_dispatch:

jobs:
  allure:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Java
        uses: actions/setup-java@v4
        with:
          distribution: "temurin"
          java-version: "17"

      - name: Install Allure
        run: |
          curl -Ls https://github.com/allure-framework/allure2/releases/latest/download/allure-2.25.0.tgz | tar zx
          sudo mv allure-2.25.0 /opt/allure
          sudo ln -sf /opt/allure/bin/allure /usr/bin/allure

      - name: Generate Allure Report
        run: |
          allure generate allure-results \
            --clean \
            -o allure-report

      - name: Summary
        run: |
          echo "## ðŸ“Š Allure Report" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "HistÃ³rico consolidado (Ãºltimos 5 testes)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ”— https://dulley-vz.github.io/allure-test-video-duley/" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
